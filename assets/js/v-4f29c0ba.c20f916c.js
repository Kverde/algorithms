"use strict";(self.webpackChunkalgorithms_way23_ru=self.webpackChunkalgorithms_way23_ru||[]).push([[9248],{9626:(n,s,a)=>{a.r(s),a.d(s,{data:()=>e});const e=JSON.parse('{"key":"v-4f29c0ba","path":"/20221023132701.html","title":"Оператор case: вариант по умолчанию для выявления ошибок","lang":"ru-RU","frontmatter":{"page_type":"code_tricks"},"excerpt":"","headers":[{"level":2,"title":"Ссылки","slug":"ссылки","link":"#ссылки","children":[]},{"level":2,"title":"Ссылки на эту заметку","slug":"ссылки-на-эту-заметку","link":"#ссылки-на-эту-заметку","children":[]}],"git":{"updatedTime":1669660493000},"filePathRelative":"20221023132701.md"}')},894:(n,s,a)=>{a.r(s),a.d(s,{default:()=>v});var e=a(6252);const p=(0,e._)("h1",{id:"оператор-case-вариант-по-умолчанию-для-выявления-ошибок",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#оператор-case-вариант-по-умолчанию-для-выявления-ошибок","aria-hidden":"true"},"#"),(0,e.Uk)(" Оператор case: вариант по умолчанию для выявления ошибок")],-1),t=(0,e._)("code",null,"case",-1),l=(0,e._)("code",null,"elif",-1),o=(0,e.uE)('<p>Рассмотрим несколько вариантов функции <code>day_of_week</code> которая принимает в качестве аргумента номер дня недели и возвращает его название. Нумерация дней недели начинается с нуля.</p><p>В первом случае ситуация когда передан неверный номер не обрабатывается.</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">day_of_week1</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> num <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Понедельник&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Вторник&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Среда&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Четверг&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Пятница&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Суббота&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Воскресенье&#39;</span>\n\n    <span class="token keyword">return</span> dayName\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Если передать неверный номер то произойдет исключение, но понять его причину будет сложно.</p><div class="language-textile line-numbers-mode" data-ext="textile"><pre class="language-textile"><code><span class="token phrase">UnboundLocalError: local variable &#39;dayName&#39; referenced before assignment\n</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>В случае если добавить вариант по умолчанию с каким-то значением то проблема только усугубляется.</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">day_of_week2</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> num <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Понедельник&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Вторник&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Среда&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Четверг&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Пятница&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Суббота&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Воскресенье&#39;</span>\n    <span class="token keyword">else</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Неверный день недели&#39;</span>\n\n    <span class="token keyword">return</span> dayName\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Предположим эта функция используется для составления отчёта и в неё попало ошибочное число номера дня. Теперь проблема не будет обнаружена сразу при генерации отчета, её получится найти только если просмотреть отчёт, что снижает вероятность обнаружения ошибки.</p><p>Генерация исключения в варианте по умолчанию позволяет с одной стороны быстрее обнаружить проблему, а с другой по исключению догадаться о возможных источниках проблемы.</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">day_of_week3</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> num <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Понедельник&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Вторник&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Среда&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Четверг&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Пятница&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Суббота&#39;</span>\n    <span class="token keyword">elif</span> num <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">:</span>\n        dayName <span class="token operator">=</span> <span class="token string">&#39;Воскресенье&#39;</span>\n    <span class="token keyword">else</span><span class="token punctuation">:</span>\n        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">&#39;Неверный день недели&#39;</span><span class="token punctuation">)</span>\n\n    <span class="token keyword">return</span> dayName\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Сообщение об исключении теперь значительно более понятное:</p><div class="language-textile line-numbers-mode" data-ext="textile"><pre class="language-textile"><code><span class="token phrase">ValueError: Неверный день недели\n</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>',12),i=(0,e.uE)('<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">day_of_week4</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> num <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token string">&#39;Понедельник&#39;</span>\n    <span class="token keyword">if</span> num <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token string">&#39;Вторник&#39;</span>\n    <span class="token keyword">if</span> num <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token string">&#39;Среда&#39;</span>\n    <span class="token keyword">if</span> num <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token string">&#39;Четверг&#39;</span>\n    <span class="token keyword">if</span> num <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token string">&#39;Пятница&#39;</span>\n    <span class="token keyword">if</span> num <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token string">&#39;Суббота&#39;</span>\n    <span class="token keyword">if</span> num <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token string">&#39;Воскресенье&#39;</span>\n\n    <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">&#39;Неверный день недели&#39;</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',1),c={href:"https://peps.python.org/pep-0622/",target:"_blank",rel:"noopener noreferrer"},r=(0,e.uE)('<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">day_of_week5</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">match</span> num<span class="token punctuation">:</span>\n        <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token string">&#39;Понедельник&#39;</span>\n        <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token string">&#39;Вторник&#39;</span>\n        <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token string">&#39;Среда&#39;</span>\n        <span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token string">&#39;Четверг&#39;</span>\n        <span class="token keyword">case</span> <span class="token number">4</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token string">&#39;Пятница&#39;</span>\n        <span class="token keyword">case</span> <span class="token number">5</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token string">&#39;Суббота&#39;</span>\n        <span class="token keyword">case</span> <span class="token number">6</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token string">&#39;Воскресенье&#39;</span>\n        <span class="token keyword">case</span> <span class="token keyword">_</span><span class="token punctuation">:</span>\n            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">&#39;Неверный день недели&#39;</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ссылки" tabindex="-1"><a class="header-anchor" href="#ссылки" aria-hidden="true">#</a> Ссылки</h2>',2),d=(0,e._)("h2",{id:"ссылки-на-эту-заметку",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#ссылки-на-эту-заметку","aria-hidden":"true"},"#"),(0,e.Uk)(" Ссылки на эту заметку")],-1),u=(0,e._)("p",{style:{"text-align":"right"}},[(0,e._)("a",{href:"https://github.com/Kverde/algorithms/blob/main/source/20221023132701.md",target:"_blank"}," Эта заметка на GitHub ")],-1),k=(0,e._)("p",{style:{"text-align":"right"}},[(0,e._)("a",{href:"https://discourse.comtext.space/new-topic?title=%D0%9E%D0%BF%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80%20case%3A%20%D0%B2%D0%B0%D1%80%D0%B8%D0%B0%D0%BD%D1%82%20%D0%BF%D0%BE%20%D1%83%D0%BC%D0%BE%D0%BB%D1%87%D0%B0%D0%BD%D0%B8%D1%8E%20%D0%B4%D0%BB%D1%8F%20%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BE%D1%88%D0%B8%D0%B1%D0%BE%D0%BA&body=&category=algorithm",target:"_blank"}," Обсудить на форуме ")],-1),m={},v=(0,a(3744).Z)(m,[["render",function(n,s){const a=(0,e.up)("RouterLink"),m=(0,e.up)("ExternalLinkIcon");return(0,e.wg)(),(0,e.iD)("div",null,[p,(0,e._)("p",null,[(0,e.Uk)("Если раздел по умолчанию оператора "),t,(0,e.Uk)(" (либо заменяющего его набора "),l,(0,e.Uk)(") не имеет назначения в текущем алгоритме, то генерируйте в нём исключение. Так при корректной работе кода вариант по умолчанию не подразумевается, значит если он всё-таки будет выполнен, то случилось что-то непредвиденное. Эту ситуацию "),(0,e.Wm)(a,{to:"/20221023131820.html"},{default:(0,e.w5)((()=>[(0,e.Uk)("полезно обнаружить как можно раньше")])),_:1}),(0,e.Uk)(".")]),o,(0,e._)("p",null,[(0,e.Uk)("Дополнительно улучшить код можно переписав его с помощью "),(0,e.Wm)(a,{to:"/20221023132846.html"},{default:(0,e.w5)((()=>[(0,e.Uk)("блоков с выходом")])),_:1}),(0,e.Uk)(":")]),i,(0,e._)("p",null,[(0,e.Uk)("Использование "),(0,e._)("a",c,[(0,e.Uk)("конструкции switch"),(0,e.Wm)(m)]),(0,e.Uk)(" ничего принципиально не меняет.")]),r,(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Wm)(a,{to:"/McConnellCodeComplete2014.html"},{default:(0,e.w5)((()=>[(0,e.Uk)("Совершенный код. Второе издание. Стив Макконнелл. Русская редакция. 2014")])),_:1}),(0,e.Uk)(". Часть IV Операторы. 15 Условные операторы. 15.2. Операторы case")])]),d,(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Wm)(a,{to:"/20221023131820.html"},{default:(0,e.w5)((()=>[(0,e.Uk)("Явные ошибки лучше скрытых")])),_:1})])]),u,k])}]])}}]);